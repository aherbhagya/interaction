[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Lead", 
  "modified": "2017-11-25 18:28:29.609626", 
  "name": "Lead-Client", 
  "script": "frappe.ui.form.on(\"Lead\", \"refresh\", function(frm, doctype, name) {\ncur_frm.add_custom_button(__('Add Interaction'), function() {\nvar d = frappe.prompt([\n    {'fieldname': 'person_interacted_with', 'fieldtype': 'Data', 'label': 'Person Interacted with', 'reqd': 0},   \n    {label:__(\"Type of Interaction\"), fieldtype:\"Select\",'default': \"Follow Up Call\",\n                    options: [\"Cold Call\",\"Follow Up Call\",\"Mail\",\"Cold Visit\",\"Follow Up Visit\",\"Existing Customer Visit\",\"SMS or Whatsapp\",\"Skype or Webex\"],\n                    fieldname:\"type_of_interaction\"},\n    {label:__(\"Result\"), fieldtype:\"Select\", options:\n    [\"Status Quo\",\"Warmer\",\"Colder\",\"Closed Lost\",\"Closed Won\"], fieldname:\"result\"},\n    {'fieldname': 'responsible', 'fieldtype': 'Link', options:\"User\", 'default': user, 'label': 'Responsible', 'reqd': 0},\n    {'fieldname': 'create_task', 'fieldtype': 'Check', 'default': true, 'label': 'Create Task'},\n    {fieldtype: \"Column Break\"},\n\n    {'fieldname': 'next_date', 'fieldtype': 'Date',\n    'label': 'Next Action Date', 'default': frappe.datetime.add_days(frappe.datetime.nowdate(),7), 'reqd': 0},\n    {'fieldname': 'next_action_by', 'fieldtype': 'Link', options:\"User\", 'default': user,'label': 'Next Action By', 'reqd': 0},\n    {'fieldname': 'comment', 'fieldtype': 'Text', 'label': 'Next Action Task', 'reqd': 1},\n    {fieldtype: \"Section Break\"},\n\n    {'fieldname': 'remarks', 'fieldtype': 'Text Editor', 'label': 'Remarks', 'reqd': 1}\n    {'fieldname': 'comment', 'fieldtype': 'Text', 'label': 'Next Action Task', 'reqd': 1},\n    {fieldtype: \"Section Break\", collapsible:true},\n    {'fieldname': 'is_expense', 'fieldtype': 'Check', 'label': 'Is Expense'},             \n    {'fieldname': 'expense_type', 'fieldtype': 'Link', options:\"Expense Claim Type\", depends_on: 1\n    ,'label': 'Expense Claim Type', 'reqd': 0},           \n    {'fieldname': 'claim_amount', 'fieldtype': 'Currency', 'label': 'Expense Amount', 'reqd': 0},\n    {'fieldname': 'expense_date', 'fieldtype': 'Date', 'label': 'Expense Date',\n    'default': frappe.datetime.add_days(frappe.datetime.nowdate(),0), 'reqd': 1},\n    {fieldtype: \"Column Break\"},               \n    {'fieldname': 'exp_approver', 'fieldtype': 'Link', options:\"User\",\n    'default': user,'label': 'Expense Approver', 'reqd': 0},\n    {'fieldname': 'description', 'fieldtype': 'Text', 'label': 'Description'},\n\n\n],\n                    var fd = d.fields_dict;\n                     $(fd.expense_date.wrapper).toggle(false);\n                     $(fd.expense_type.wrapper).toggle(false);               \n                     $(fd.claim_amount.wrapper).toggle(false);              \n                     $(fd.exp_approver.wrapper).toggle(false);               \n                     $(fd.description.wrapper).toggle(false);   \n                     // account type if ledger\\n       \n                     $(fd.is_expense.input).change(function() {           \n                        console.log(\"in chage\");          \n                        if($(this).prop(\"checked\")) {               \n                            $(fd.expense_date.wrapper).toggle(true);               \n                            $(fd.expense_type.wrapper).toggle(true);            \n                            $(fd.claim_amount.wrapper).toggle(true);              \n                            $(fd.exp_approver.wrapper).toggle(true);              \n                            $(fd.description.wrapper).toggle(true);               \n                            fd.expense_date.$input.trigger(\"change\");               \n                            fd.expense_type.$input.trigger(\"change\");              \n                            fd.claim_amount.$input.trigger(\"change\");               \n                            fd.exp_approver.$input.trigger(\"change\");               \n                            fd.description.$input.trigger(\"change\");               \n                            d.fields_dict.claim_amount.df.reqd=1;               \n                            d.fields_dict.expense_type.df.reqd=1;             \n                            d.fields_dict.description.df.reqd=1;            \n                            d.fields_dict.claim_amount.refresh();             \n                            d.fields_dict.expense_type.refresh();            \n                            d.fields_dict.description.refresh();\n                        }\n                        else {               \n                            $(fd.expense_date.wrapper).toggle(false);               \n                            $(fd.expense_type.wrapper).toggle(false);               \n                            $(fd.claim_amount.wrapper).toggle(false);               \n                            $(fd.exp_approver.wrapper).toggle(false);               \n                            $(fd.description.wrapper).toggle(false);               \n                            fd.expense_date.$input.trigger(\"change\");               \n                            fd.expense_type.$input.trigger(\"change\");               \n                            fd.claim_amount.$input.trigger(\"change\");               \n                            fd.exp_approver.$input.trigger(\"change\");               \n                            fd.description.$input.trigger(\"change\");               \n                            d.fields_dict.claim_amount.df.reqd=0;               \n                            d.fields_dict.expense_type.df.reqd=0;             \n                            d.fields_dict.description.df.reqd=0;              \n                            d.fields_dict.claim_amount.refresh();             \n                            d.fields_dict.expense_type.refresh();              \n                            d.fields_dict.description.refresh();          \n                        }          \n            });\nfunction(values){\n    var c = d.get_values()\n    var cmnt = \"Person Interacted with: \"+ c.person_interacted_with\n               +\"<br>Type of Interaction: \"+ c.type_of_interaction\n               +\"<br>Result: \"+ c.result\n               +\"<br>Next Action Date: \" +c.next_date\n               +\"<br>Next Action By: \"+ c.next_action_by\n               + \"<br>Next Action Task: \"+c.comment\n               + \"<br>Responsible: \"+c.responsible\n               + \"<br>Remarks: \"+c.remarks\n    var me = frm.doc           // start interaction master\\n          \n    if(c.is_expense){                   \n            frappe.call({                     \n                method: \"interaction.custom_methods.add_expense_claim\", \n                args: {                          \n                    doc:{                            \n                            doctype: \"Expense Claim\",                               \n                            exp_approver: c.exp_approver, \n                            responsible: c.responsible,\n                            \"expenses\":[{ \"expense_type\": c.expense_type,    \n                            \"expense_date\": c.expense_date,                                 \n                            \"claim_amount\": c.claim_amount,                                 \n                            \"description\": c.description,                              \n                            }],    \n                        }\n                    },                     \n                    callback: function(r) {      \n                        msgprint(\"Expense Claim Created\");            \n                    }         \n            });          \n    }\n        \n    var me = frm.doc\n    // start interaction master\n       frappe.call({\n            method: \"interaction.custom_methods.add_interaction\",\n            args: {\n                doc:{\n                    doctype: \"Interaction Master\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    result: c.result,\n                    person_interacted_with: c.person_interacted_with,\n\n     //                responce_reson: c.responce_reson,\n                    next_action_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    // result: c.result,\n                    next_action_by: c.next_action_by,\n                    next_action_task: c.comment,\n                    remakrs: c.remarks,\n                    responsible: c.responsible\n                    // next_date\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction master record created\");\n            }\n        });\n    //end interaction master\n//create todo\nconsole.log(c.create_task);\n    if(c.create_task==true){\n        frappe.call({\n                        method: \"interaction.custom_methods.create_todo\",\n                        args: {\n                            owner: c.next_action_by,\n                            assigned_by: c.responsible,\n                            description: c.comment,\n                            date: c.next_date,\n                            reference_name: frm.doc.name,\n                            reference_type: frm.doc.doctype\n                        }\n                    })\n    }\n//end of create todo\n\n    return frappe.call({\n            method: \"frappe.desk.form.utils.add_comment\",\n            args: {\n                doc:{\n                    doctype: \"Communication\",\n                    communication_type: \"Comment\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    comment: \"cmnt\",\n                    subject: \"cmnt\",\n                    content: cmnt,\n                    responce_reson: c.responce_reson,\n                    next_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    result: c.result,\n                    next_action_by: c.next_action_by,\n                    reference_owner: frm.doc.owner,\n                    comment_by: user,\n                    user: user,\n                    sender_full_name:user_fullname,\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction Submited Successfully\");\n                        cur_frm.reload_doc();\n            if (cur_frm) {\n                        if (cur_frm.docname && (frappe.last_edited_communication[cur_frm.doctype] || {})[cur_frm.docname]) {\n                            delete frappe.last_edited_communication[cur_frm.doctype][cur_frm.docname];\n                        }\n                    }\n            }\n        });\n},\n'Add Interaction',\n'Submit','Add Interaction', \"btn-default\"\n)\n});\n\n                        // frm.refresh();\n\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Opportunity", 
  "modified": "2017-04-20 09:21:03.532779", 
  "name": "Opportunity-Client", 
  "script": "\nfrappe.ui.form.on(\"Opportunity\", \"refresh\", function(frm, doctype, name) {\ncur_frm.add_custom_button(__('Add Interaction'), function() {\nvar d = frappe.prompt([\n    {'fieldname': 'person_interacted_with', 'fieldtype': 'Data', 'label': 'Person Interacted with', 'reqd': 0},    \n    {label:__(\"Type of Interaction\"), fieldtype:\"Select\",'default': \"Call\",\n                    options: [\"Email\",\"Call\",\"Follow Up Call\",\"Demo\",\"Email Contract\"],\n                    fieldname:\"type_of_interaction\"},\n    {label:__(\"Result\"), fieldtype:\"Select\", options: \n    [\"Status Quo\",\"Warmer\",\"Colder\",\"Closed Lost\",\"Closed Won\"], fieldname:\"result\"},\n    {'fieldname': 'responsible', 'fieldtype': 'Link', options:\"User\", 'default': user, 'label': 'Responsible', 'reqd': 0},\n    {'fieldname': 'create_task', 'fieldtype': 'Check', 'default': true, 'label': 'Create Task'},\n  \n\n    {fieldtype: \"Column Break\"},\n\n \n    {'fieldname': 'next_date', 'fieldtype': 'Date', \n    'label': 'Next Action Date', 'default': frappe.datetime.add_days(frappe.datetime.nowdate(),7), 'reqd': 0},\n    {'fieldname': 'next_action_by', 'fieldtype': 'Link', options:\"User\", 'default': user,'label': 'Next Action By', 'reqd': 0},\n    {'fieldname': 'comment', 'fieldtype': 'Text', 'label': 'Next Action Task', 'reqd': 1},\n    {fieldtype: \"Section Break\"},\n\n    {'fieldname': 'remark', 'fieldtype': 'Text Editor', 'label': 'Remarks', 'reqd': 1} \n\n\n],\nfunction(values){\n    var c = d.get_values()\n    var cmnt = \"Person Interacted with: \"+ c.person_interacted_with\n               +\"<br>Type of Interaction: \"+ c.type_of_interaction\n               +\"<br>Result: \"+ c.result \n               +\"<br>Next Action Date: \" +c.next_date \n               +\"<br>Next Action By: \"+ c.next_action_by \n               + \"<br>Next Action Task: \"+c.comment \n               + \"<br>Responsible: \"+c.responsible \n               + \"<br>Remarks: \"+c.remark \n\n                \n    var me = frm.doc\n    // start interaction master\n       frappe.call({\n            method: \"allyhomes.custom_method.add_interaction\",\n            args: {\n                doc:{\n                    doctype: \"Interaction Master\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    result: c.result,\n                    person_interacted_with: c.person_interacted_with,\n\n     //                responce_reson: c.responce_reson,\n                    next_action_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    // result: c.result,\n                    next_action_by: c.next_action_by,\n                    next_action_task: c.comment,\n                    remark: c.remark,\n                    responsible: c.responsible\n                    // next_date\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction master record created\");\n            }\n        });\n    //end interaction master\n//create todo\n    if(c.create_task==true){\n        frappe.call({\n                        method: \"allyhomes.custom_method.create_todo\",\n                        args: {\n                            owner: c.next_action_by,\n                            assigned_by: c.responsible,\n                            description: c.comment,\n                            date: c.next_date,\n                            reference_name: frm.doc.name,\n                            reference_type: frm.doc.doctype\n                        }\n                    })\n    }\n//end of create todo\n\n    return frappe.call({\n            method: \"frappe.desk.form.utils.add_comment\",\n            args: {\n                doc:{\n                    doctype: \"Communication\",\n                    communication_type: \"Comment\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    comment: \"cmnt\",\n                    subject: \"cmnt\",\n                    content: cmnt,\n                    responce_reson: c.responce_reson,\n                    next_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    result: c.result,\n                    next_action_by: c.next_action_by,\n                    reference_owner: frm.doc.owner,\n                    comment_by: user,\n                    user: user,\n                    sender_full_name:user_fullname,\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction Submited Successfully\");\n                        cur_frm.reload_doc();\n            if (cur_frm) {\n                        if (cur_frm.docname && (frappe.last_edited_communication[cur_frm.doctype] || {})[cur_frm.docname]) {\n                            delete frappe.last_edited_communication[cur_frm.doctype][cur_frm.docname];\n                        }\n                    }\n            }\n        });\n},\n'Add Interaction',\n'Submit','Add Interaction', \"btn-default\"\n)\n});\n\n                        // frm.refresh();\n\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Supplier", 
  "modified": "2017-04-20 09:20:24.352341", 
  "name": "Supplier-Client", 
  "script": "\nfrappe.ui.form.on(\"Supplier\", \"refresh\", function(frm, doctype, name) {\ncur_frm.add_custom_button(__('Add Interaction'), function() {\nvar d = frappe.prompt([\n    {'fieldname': 'person_interacted_with', 'fieldtype': 'Data', 'label': 'Person Interacted with', 'reqd': 0},    \n    {label:__(\"Type of Interaction\"), fieldtype:\"Select\",'default': \"Call\",\n                    options: [\"Email\",\"Call\",\"Follow Up Call\",\"Demo\",\"Email Contract\"],\n                    fieldname:\"type_of_interaction\"},\n    {label:__(\"Result\"), fieldtype:\"Select\", options: \n    [\"Status Quo\",\"Warmer\",\"Colder\",\"Closed Lost\",\"Closed Won\"], fieldname:\"result\"},\n    {'fieldname': 'responsible', 'fieldtype': 'Link', options:\"User\", 'default': user, 'label': 'Responsible', 'reqd': 0},\n    {'fieldname': 'create_task', 'fieldtype': 'Check', 'default': true, 'label': 'Create Task'},\n  \n\n    {fieldtype: \"Column Break\"},\n\n \n    {'fieldname': 'next_date', 'fieldtype': 'Date', \n    'label': 'Next Action Date', 'default': frappe.datetime.add_days(frappe.datetime.nowdate(),7), 'reqd': 0},\n    {'fieldname': 'next_action_by', 'fieldtype': 'Link', options:\"User\", 'default': user,'label': 'Next Action By', 'reqd': 0},\n    {'fieldname': 'comment', 'fieldtype': 'Text', 'label': 'Next Action Task', 'reqd': 1},\n    {fieldtype: \"Section Break\"},\n\n    {'fieldname': 'remark', 'fieldtype': 'Text Editor', 'label': 'Remarks', 'reqd': 1} \n\n\n],\nfunction(values){\n    var c = d.get_values()\n    var cmnt = \"Person Interacted with: \"+ c.person_interacted_with\n               +\"<br>Type of Interaction: \"+ c.type_of_interaction\n               +\"<br>Result: \"+ c.result \n               +\"<br>Next Action Date: \" +c.next_date \n               +\"<br>Next Action By: \"+ c.next_action_by \n               + \"<br>Next Action Task: \"+c.comment \n               + \"<br>Responsible: \"+c.responsible \n               + \"<br>Remarks: \"+c.remark \n\n                \n    var me = frm.doc\n    // start interaction master\n       frappe.call({\n            method: \"allyhomes.custom_method.add_interaction\",\n            args: {\n                doc:{\n                    doctype: \"Interaction Master\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    result: c.result,\n                    person_interacted_with: c.person_interacted_with,\n\n     //                responce_reson: c.responce_reson,\n                    next_action_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    // result: c.result,\n                    next_action_by: c.next_action_by,\n                    next_action_task: c.comment,\n                    remark: c.remark,\n                    responsible: c.responsible\n                    // next_date\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction master record created\");\n            }\n        });\n    //end interaction master\n//create todo\n    if(c.create_task==true){\n        frappe.call({\n                        method: \"allyhomes.custom_method.create_todo\",\n                        args: {\n                            owner: c.next_action_by,\n                            assigned_by: c.responsible,\n                            description: c.comment,\n                            date: c.next_date,\n                            reference_name: frm.doc.name,\n                            reference_type: frm.doc.doctype\n                        }\n                    })\n    }\n//end of create todo\n\n    return frappe.call({\n            method: \"frappe.desk.form.utils.add_comment\",\n            args: {\n                doc:{\n                    doctype: \"Communication\",\n                    communication_type: \"Comment\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    comment: \"cmnt\",\n                    subject: \"cmnt\",\n                    content: cmnt,\n                    responce_reson: c.responce_reson,\n                    next_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    result: c.result,\n                    next_action_by: c.next_action_by,\n                    reference_owner: frm.doc.owner,\n                    comment_by: user,\n                    user: user,\n                    sender_full_name:user_fullname,\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction Submited Successfully\");\n                        cur_frm.reload_doc();\n            if (cur_frm) {\n                        if (cur_frm.docname && (frappe.last_edited_communication[cur_frm.doctype] || {})[cur_frm.docname]) {\n                            delete frappe.last_edited_communication[cur_frm.doctype][cur_frm.docname];\n                        }\n                    }\n            }\n        });\n},\n'Add Interaction',\n'Submit','Add Interaction', \"btn-default\"\n)\n});\n\n                        // frm.refresh();\n\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Quotation", 
  "modified": "2017-04-20 09:18:54.846911", 
  "name": "Quotation-Client", 
  "script": "\nfrappe.ui.form.on(\"Quotation\", \"refresh\", function(frm, doctype, name) {\ncur_frm.add_custom_button(__('Add Interaction'), function() {\nvar d = frappe.prompt([\n    {'fieldname': 'person_interacted_with', 'fieldtype': 'Data', 'label': 'Person Interacted with', 'reqd': 0},    \n    {label:__(\"Type of Interaction\"), fieldtype:\"Select\",'default': \"Call\",\n                    options: [\"Email\",\"Call\",\"Follow Up Call\",\"Demo\",\"Email Contract\"],\n                    fieldname:\"type_of_interaction\"},\n    {label:__(\"Result\"), fieldtype:\"Select\", options: \n    [\"Status Quo\",\"Warmer\",\"Colder\",\"Closed Lost\",\"Closed Won\"], fieldname:\"result\"},\n    {'fieldname': 'responsible', 'fieldtype': 'Link', options:\"User\", 'default': user, 'label': 'Responsible', 'reqd': 0},\n    {'fieldname': 'create_task', 'fieldtype': 'Check', 'default': true, 'label': 'Create Task'},\n  \n\n    {fieldtype: \"Column Break\"},\n\n \n    {'fieldname': 'next_date', 'fieldtype': 'Date', \n    'label': 'Next Action Date', 'default': frappe.datetime.add_days(frappe.datetime.nowdate(),7), 'reqd': 0},\n    {'fieldname': 'next_action_by', 'fieldtype': 'Link', options:\"User\", 'default': user,'label': 'Next Action By', 'reqd': 0},\n    {'fieldname': 'comment', 'fieldtype': 'Text', 'label': 'Next Action Task', 'reqd': 1},\n    {fieldtype: \"Section Break\"},\n\n    {'fieldname': 'remark', 'fieldtype': 'Text Editor', 'label': 'Remarks', 'reqd': 1} \n\n\n],\nfunction(values){\n    var c = d.get_values()\n    var cmnt = \"Person Interacted with: \"+ c.person_interacted_with\n               +\"<br>Type of Interaction: \"+ c.type_of_interaction\n               +\"<br>Result: \"+ c.result \n               +\"<br>Next Action Date: \" +c.next_date \n               +\"<br>Next Action By: \"+ c.next_action_by \n               + \"<br>Next Action Task: \"+c.comment \n               + \"<br>Responsible: \"+c.responsible \n               + \"<br>Remarks: \"+c.remark \n\n                \n    var me = frm.doc\n    // start interaction master\n       frappe.call({\n            method: \"allyhomes.custom_method.add_interaction\",\n            args: {\n                doc:{\n                    doctype: \"Interaction Master\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    result: c.result,\n                    person_interacted_with: c.person_interacted_with,\n\n     //                responce_reson: c.responce_reson,\n                    next_action_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    // result: c.result,\n                    next_action_by: c.next_action_by,\n                    next_action_task: c.comment,\n                    remark: c.remark,\n                    responsible: c.responsible\n                    // next_date\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction master record created\");\n            }\n        });\n    //end interaction master\n//create todo\n    if(c.create_task==true){\n        frappe.call({\n                        method: \"allyhomes.custom_method.create_todo\",\n                        args: {\n                            owner: c.next_action_by,\n                            assigned_by: c.responsible,\n                            description: c.comment,\n                            date: c.next_date,\n                            reference_name: frm.doc.name,\n                            reference_type: frm.doc.doctype\n                        }\n                    })\n    }\n//end of create todo\n\n    return frappe.call({\n            method: \"frappe.desk.form.utils.add_comment\",\n            args: {\n                doc:{\n                    doctype: \"Communication\",\n                    communication_type: \"Comment\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    comment: \"cmnt\",\n                    subject: \"cmnt\",\n                    content: cmnt,\n                    responce_reson: c.responce_reson,\n                    next_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    result: c.result,\n                    next_action_by: c.next_action_by,\n                    reference_owner: frm.doc.owner,\n                    comment_by: user,\n                    user: user,\n                    sender_full_name:user_fullname,\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction Submited Successfully\");\n                        cur_frm.reload_doc();\n            if (cur_frm) {\n                        if (cur_frm.docname && (frappe.last_edited_communication[cur_frm.doctype] || {})[cur_frm.docname]) {\n                            delete frappe.last_edited_communication[cur_frm.doctype][cur_frm.docname];\n                        }\n                    }\n            }\n        });\n},\n'Add Interaction',\n'Submit','Add Interaction', \"btn-default\"\n)\n});\n\n                        // frm.refresh();\n\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Order", 
  "modified": "2017-04-20 09:21:24.740158", 
  "name": "Sales Order-Client", 
  "script": "\nfrappe.ui.form.on(\"Sales Order\", \"refresh\", function(frm, doctype, name) {\ncur_frm.add_custom_button(__('Add Interaction'), function() {\nvar d = frappe.prompt([\n    {'fieldname': 'person_interacted_with', 'fieldtype': 'Data', 'label': 'Person Interacted with', 'reqd': 0},    \n    {label:__(\"Type of Interaction\"), fieldtype:\"Select\",'default': \"Call\",\n                    options: [\"Email\",\"Call\",\"Follow Up Call\",\"Demo\",\"Email Contract\"],\n                    fieldname:\"type_of_interaction\"},\n    {label:__(\"Result\"), fieldtype:\"Select\", options: \n    [\"Status Quo\",\"Warmer\",\"Colder\",\"Closed Lost\",\"Closed Won\"], fieldname:\"result\"},\n    {'fieldname': 'responsible', 'fieldtype': 'Link', options:\"User\", 'default': user, 'label': 'Responsible', 'reqd': 0},\n    {'fieldname': 'create_task', 'fieldtype': 'Check', 'default': true, 'label': 'Create Task'},\n  \n\n    {fieldtype: \"Column Break\"},\n\n \n    {'fieldname': 'next_date', 'fieldtype': 'Date', \n    'label': 'Next Action Date', 'default': frappe.datetime.add_days(frappe.datetime.nowdate(),7), 'reqd': 0},\n    {'fieldname': 'next_action_by', 'fieldtype': 'Link', options:\"User\", 'default': user,'label': 'Next Action By', 'reqd': 0},\n    {'fieldname': 'comment', 'fieldtype': 'Text', 'label': 'Next Action Task', 'reqd': 1},\n    {fieldtype: \"Section Break\"},\n\n    {'fieldname': 'remark', 'fieldtype': 'Text Editor', 'label': 'Remarks', 'reqd': 1} \n\n\n],\nfunction(values){\n    var c = d.get_values()\n    var cmnt = \"Person Interacted with: \"+ c.person_interacted_with\n               +\"<br>Type of Interaction: \"+ c.type_of_interaction\n               +\"<br>Result: \"+ c.result \n               +\"<br>Next Action Date: \" +c.next_date \n               +\"<br>Next Action By: \"+ c.next_action_by \n               + \"<br>Next Action Task: \"+c.comment \n               + \"<br>Responsible: \"+c.responsible \n               + \"<br>Remarks: \"+c.remark \n\n                \n    var me = frm.doc\n    // start interaction master\n       frappe.call({\n            method: \"allyhomes.custom_method.add_interaction\",\n            args: {\n                doc:{\n                    doctype: \"Interaction Master\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    result: c.result,\n                    person_interacted_with: c.person_interacted_with,\n\n     //                responce_reson: c.responce_reson,\n                    next_action_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    // result: c.result,\n                    next_action_by: c.next_action_by,\n                    next_action_task: c.comment,\n                    remark: c.remark,\n                    responsible: c.responsible\n                    // next_date\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction master record created\");\n            }\n        });\n    //end interaction master\n//create todo\n    if(c.create_task==true){\n        frappe.call({\n                        method: \"allyhomes.custom_method.create_todo\",\n                        args: {\n                            owner: c.next_action_by,\n                            assigned_by: c.responsible,\n                            description: c.comment,\n                            date: c.next_date,\n                            reference_name: frm.doc.name,\n                            reference_type: frm.doc.doctype\n                        }\n                    })\n    }\n//end of create todo\n\n    return frappe.call({\n            method: \"frappe.desk.form.utils.add_comment\",\n            args: {\n                doc:{\n                    doctype: \"Communication\",\n                    communication_type: \"Comment\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    comment: \"cmnt\",\n                    subject: \"cmnt\",\n                    content: cmnt,\n                    responce_reson: c.responce_reson,\n                    next_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    result: c.result,\n                    next_action_by: c.next_action_by,\n                    reference_owner: frm.doc.owner,\n                    comment_by: user,\n                    user: user,\n                    sender_full_name:user_fullname,\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction Submited Successfully\");\n                        cur_frm.reload_doc();\n            if (cur_frm) {\n                        if (cur_frm.docname && (frappe.last_edited_communication[cur_frm.doctype] || {})[cur_frm.docname]) {\n                            delete frappe.last_edited_communication[cur_frm.doctype][cur_frm.docname];\n                        }\n                    }\n            }\n        });\n},\n'Add Interaction',\n'Submit','Add Interaction', \"btn-default\"\n)\n});\n\n                        // frm.refresh();\n\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Sales Invoice", 
  "modified": "2017-04-20 09:21:57.792355", 
  "name": "Sales Invoice-Client", 
  "script": "\nfrappe.ui.form.on(\"Sales Invoice\", \"refresh\", function(frm, doctype, name) {\ncur_frm.add_custom_button(__('Add Interaction'), function() {\nvar d = frappe.prompt([\n    {'fieldname': 'person_interacted_with', 'fieldtype': 'Data', 'label': 'Person Interacted with', 'reqd': 0},    \n    {label:__(\"Type of Interaction\"), fieldtype:\"Select\",'default': \"Call\",\n                    options: [\"Email\",\"Call\",\"Follow Up Call\",\"Demo\",\"Email Contract\"],\n                    fieldname:\"type_of_interaction\"},\n    {label:__(\"Result\"), fieldtype:\"Select\", options: \n    [\"Status Quo\",\"Warmer\",\"Colder\",\"Closed Lost\",\"Closed Won\"], fieldname:\"result\"},\n    {'fieldname': 'responsible', 'fieldtype': 'Link', options:\"User\", 'default': user, 'label': 'Responsible', 'reqd': 0},\n    {'fieldname': 'create_task', 'fieldtype': 'Check', 'default': true, 'label': 'Create Task'},\n  \n\n    {fieldtype: \"Column Break\"},\n\n \n    {'fieldname': 'next_date', 'fieldtype': 'Date', \n    'label': 'Next Action Date', 'default': frappe.datetime.add_days(frappe.datetime.nowdate(),7), 'reqd': 0},\n    {'fieldname': 'next_action_by', 'fieldtype': 'Link', options:\"User\", 'default': user,'label': 'Next Action By', 'reqd': 0},\n    {'fieldname': 'comment', 'fieldtype': 'Text', 'label': 'Next Action Task', 'reqd': 1},\n    {fieldtype: \"Section Break\"},\n\n    {'fieldname': 'remark', 'fieldtype': 'Text Editor', 'label': 'Remarks', 'reqd': 1} \n\n\n],\nfunction(values){\n    var c = d.get_values()\n    var cmnt = \"Person Interacted with: \"+ c.person_interacted_with\n               +\"<br>Type of Interaction: \"+ c.type_of_interaction\n               +\"<br>Result: \"+ c.result \n               +\"<br>Next Action Date: \" +c.next_date \n               +\"<br>Next Action By: \"+ c.next_action_by \n               + \"<br>Next Action Task: \"+c.comment \n               + \"<br>Responsible: \"+c.responsible \n               + \"<br>Remarks: \"+c.remark \n\n                \n    var me = frm.doc\n    // start interaction master\n       frappe.call({\n            method: \"allyhomes.custom_method.add_interaction\",\n            args: {\n                doc:{\n                    doctype: \"Interaction Master\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    result: c.result,\n                    person_interacted_with: c.person_interacted_with,\n\n     //                responce_reson: c.responce_reson,\n                    next_action_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    // result: c.result,\n                    next_action_by: c.next_action_by,\n                    next_action_task: c.comment,\n                    remark: c.remark,\n                    responsible: c.responsible\n                    // next_date\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction master record created\");\n            }\n        });\n    //end interaction master\n//create todo\n    if(c.create_task==true){\n        frappe.call({\n                        method: \"allyhomes.custom_method.create_todo\",\n                        args: {\n                            owner: c.next_action_by,\n                            assigned_by: c.responsible,\n                            description: c.comment,\n                            date: c.next_date,\n                            reference_name: frm.doc.name,\n                            reference_type: frm.doc.doctype\n                        }\n                    })\n    }\n//end of create todo\n\n    return frappe.call({\n            method: \"frappe.desk.form.utils.add_comment\",\n            args: {\n                doc:{\n                    doctype: \"Communication\",\n                    communication_type: \"Comment\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    comment: \"cmnt\",\n                    subject: \"cmnt\",\n                    content: cmnt,\n                    responce_reson: c.responce_reson,\n                    next_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    result: c.result,\n                    next_action_by: c.next_action_by,\n                    reference_owner: frm.doc.owner,\n                    comment_by: user,\n                    user: user,\n                    sender_full_name:user_fullname,\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction Submited Successfully\");\n                        cur_frm.reload_doc();\n            if (cur_frm) {\n                        if (cur_frm.docname && (frappe.last_edited_communication[cur_frm.doctype] || {})[cur_frm.docname]) {\n                            delete frappe.last_edited_communication[cur_frm.doctype][cur_frm.docname];\n                        }\n                    }\n            }\n        });\n},\n'Add Interaction',\n'Submit','Add Interaction', \"btn-default\"\n)\n});\n\n                        // frm.refresh();\n\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Delivery Note", 
  "modified": "2017-04-20 09:22:26.233926", 
  "name": "Delivery Note-Client", 
  "script": "\nfrappe.ui.form.on(\"Delivery Note\", \"refresh\", function(frm, doctype, name) {\ncur_frm.add_custom_button(__('Add Interaction'), function() {\nvar d = frappe.prompt([\n    {'fieldname': 'person_interacted_with', 'fieldtype': 'Data', 'label': 'Person Interacted with', 'reqd': 0},    \n    {label:__(\"Type of Interaction\"), fieldtype:\"Select\",'default': \"Call\",\n                    options: [\"Email\",\"Call\",\"Follow Up Call\",\"Demo\",\"Email Contract\"],\n                    fieldname:\"type_of_interaction\"},\n    {label:__(\"Result\"), fieldtype:\"Select\", options: \n    [\"Status Quo\",\"Warmer\",\"Colder\",\"Closed Lost\",\"Closed Won\"], fieldname:\"result\"},\n    {'fieldname': 'responsible', 'fieldtype': 'Link', options:\"User\", 'default': user, 'label': 'Responsible', 'reqd': 0},\n    {'fieldname': 'create_task', 'fieldtype': 'Check', 'default': true, 'label': 'Create Task'},\n  \n\n    {fieldtype: \"Column Break\"},\n\n \n    {'fieldname': 'next_date', 'fieldtype': 'Date', \n    'label': 'Next Action Date', 'default': frappe.datetime.add_days(frappe.datetime.nowdate(),7), 'reqd': 0},\n    {'fieldname': 'next_action_by', 'fieldtype': 'Link', options:\"User\", 'default': user,'label': 'Next Action By', 'reqd': 0},\n    {'fieldname': 'comment', 'fieldtype': 'Text', 'label': 'Next Action Task', 'reqd': 1},\n    {fieldtype: \"Section Break\"},\n\n    {'fieldname': 'remark', 'fieldtype': 'Text Editor', 'label': 'Remarks', 'reqd': 1} \n\n\n],\nfunction(values){\n    var c = d.get_values()\n    var cmnt = \"Person Interacted with: \"+ c.person_interacted_with\n               +\"<br>Type of Interaction: \"+ c.type_of_interaction\n               +\"<br>Result: \"+ c.result \n               +\"<br>Next Action Date: \" +c.next_date \n               +\"<br>Next Action By: \"+ c.next_action_by \n               + \"<br>Next Action Task: \"+c.comment \n               + \"<br>Responsible: \"+c.responsible \n               + \"<br>Remarks: \"+c.remark \n\n                \n    var me = frm.doc\n    // start interaction master\n       frappe.call({\n            method: \"allyhomes.custom_method.add_interaction\",\n            args: {\n                doc:{\n                    doctype: \"Interaction Master\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    result: c.result,\n                    person_interacted_with: c.person_interacted_with,\n\n     //                responce_reson: c.responce_reson,\n                    next_action_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    // result: c.result,\n                    next_action_by: c.next_action_by,\n                    next_action_task: c.comment,\n                    remark: c.remark,\n                    responsible: c.responsible\n                    // next_date\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction master record created\");\n            }\n        });\n    //end interaction master\n//create todo\n    if(c.create_task==true){\n        frappe.call({\n                        method: \"allyhomes.custom_method.create_todo\",\n                        args: {\n                            owner: c.next_action_by,\n                            assigned_by: c.responsible,\n                            description: c.comment,\n                            date: c.next_date,\n                            reference_name: frm.doc.name,\n                            reference_type: frm.doc.doctype\n                        }\n                    })\n    }\n//end of create todo\n\n    return frappe.call({\n            method: \"frappe.desk.form.utils.add_comment\",\n            args: {\n                doc:{\n                    doctype: \"Communication\",\n                    communication_type: \"Comment\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    comment: \"cmnt\",\n                    subject: \"cmnt\",\n                    content: cmnt,\n                    responce_reson: c.responce_reson,\n                    next_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    result: c.result,\n                    next_action_by: c.next_action_by,\n                    reference_owner: frm.doc.owner,\n                    comment_by: user,\n                    user: user,\n                    sender_full_name:user_fullname,\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction Submited Successfully\");\n                        cur_frm.reload_doc();\n            if (cur_frm) {\n                        if (cur_frm.docname && (frappe.last_edited_communication[cur_frm.doctype] || {})[cur_frm.docname]) {\n                            delete frappe.last_edited_communication[cur_frm.doctype][cur_frm.docname];\n                        }\n                    }\n            }\n        });\n},\n'Add Interaction',\n'Submit','Add Interaction', \"btn-default\"\n)\n});\n\n                        // frm.refresh();\n\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Purchase Order", 
  "modified": "2017-04-20 09:22:46.543599", 
  "name": "Purchase Order-Client", 
  "script": "\nfrappe.ui.form.on(\"Purchase Order\", \"refresh\", function(frm, doctype, name) {\ncur_frm.add_custom_button(__('Add Interaction'), function() {\nvar d = frappe.prompt([\n    {'fieldname': 'person_interacted_with', 'fieldtype': 'Data', 'label': 'Person Interacted with', 'reqd': 0},    \n    {label:__(\"Type of Interaction\"), fieldtype:\"Select\",'default': \"Call\",\n                    options: [\"Email\",\"Call\",\"Follow Up Call\",\"Demo\",\"Email Contract\"],\n                    fieldname:\"type_of_interaction\"},\n    {label:__(\"Result\"), fieldtype:\"Select\", options: \n    [\"Status Quo\",\"Warmer\",\"Colder\",\"Closed Lost\",\"Closed Won\"], fieldname:\"result\"},\n    {'fieldname': 'responsible', 'fieldtype': 'Link', options:\"User\", 'default': user, 'label': 'Responsible', 'reqd': 0},\n    {'fieldname': 'create_task', 'fieldtype': 'Check', 'default': true, 'label': 'Create Task'},\n  \n\n    {fieldtype: \"Column Break\"},\n\n \n    {'fieldname': 'next_date', 'fieldtype': 'Date', \n    'label': 'Next Action Date', 'default': frappe.datetime.add_days(frappe.datetime.nowdate(),7), 'reqd': 0},\n    {'fieldname': 'next_action_by', 'fieldtype': 'Link', options:\"User\", 'default': user,'label': 'Next Action By', 'reqd': 0},\n    {'fieldname': 'comment', 'fieldtype': 'Text', 'label': 'Next Action Task', 'reqd': 1},\n    {fieldtype: \"Section Break\"},\n\n    {'fieldname': 'remark', 'fieldtype': 'Text Editor', 'label': 'Remarks', 'reqd': 1} \n\n\n],\nfunction(values){\n    var c = d.get_values()\n    var cmnt = \"Person Interacted with: \"+ c.person_interacted_with\n               +\"<br>Type of Interaction: \"+ c.type_of_interaction\n               +\"<br>Result: \"+ c.result \n               +\"<br>Next Action Date: \" +c.next_date \n               +\"<br>Next Action By: \"+ c.next_action_by \n               + \"<br>Next Action Task: \"+c.comment \n               + \"<br>Responsible: \"+c.responsible \n               + \"<br>Remarks: \"+c.remark \n\n                \n    var me = frm.doc\n    // start interaction master\n       frappe.call({\n            method: \"allyhomes.custom_method.add_interaction\",\n            args: {\n                doc:{\n                    doctype: \"Interaction Master\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    result: c.result,\n                    person_interacted_with: c.person_interacted_with,\n\n     //                responce_reson: c.responce_reson,\n                    next_action_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    // result: c.result,\n                    next_action_by: c.next_action_by,\n                    next_action_task: c.comment,\n                    remark: c.remark,\n                    responsible: c.responsible\n                    // next_date\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction master record created\");\n            }\n        });\n    //end interaction master\n//create todo\n    if(c.create_task==true){\n        frappe.call({\n                        method: \"allyhomes.custom_method.create_todo\",\n                        args: {\n                            owner: c.next_action_by,\n                            assigned_by: c.responsible,\n                            description: c.comment,\n                            date: c.next_date,\n                            reference_name: frm.doc.name,\n                            reference_type: frm.doc.doctype\n                        }\n                    })\n    }\n//end of create todo\n\n    return frappe.call({\n            method: \"frappe.desk.form.utils.add_comment\",\n            args: {\n                doc:{\n                    doctype: \"Communication\",\n                    communication_type: \"Comment\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    comment: \"cmnt\",\n                    subject: \"cmnt\",\n                    content: cmnt,\n                    responce_reson: c.responce_reson,\n                    next_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    result: c.result,\n                    next_action_by: c.next_action_by,\n                    reference_owner: frm.doc.owner,\n                    comment_by: user,\n                    user: user,\n                    sender_full_name:user_fullname,\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction Submited Successfully\");\n                        cur_frm.reload_doc();\n            if (cur_frm) {\n                        if (cur_frm.docname && (frappe.last_edited_communication[cur_frm.doctype] || {})[cur_frm.docname]) {\n                            delete frappe.last_edited_communication[cur_frm.doctype][cur_frm.docname];\n                        }\n                    }\n            }\n        });\n},\n'Add Interaction',\n'Submit','Add Interaction', \"btn-default\"\n)\n});\n\n                        // frm.refresh();\n\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Purchase Invoice", 
  "modified": "2017-04-20 09:23:09.158838", 
  "name": "Purchase Invoice-Client", 
  "script": "\nfrappe.ui.form.on(\"Purchase Invoice\", \"refresh\", function(frm, doctype, name) {\ncur_frm.add_custom_button(__('Add Interaction'), function() {\nvar d = frappe.prompt([\n    {'fieldname': 'person_interacted_with', 'fieldtype': 'Data', 'label': 'Person Interacted with', 'reqd': 0},    \n    {label:__(\"Type of Interaction\"), fieldtype:\"Select\",'default': \"Call\",\n                    options: [\"Email\",\"Call\",\"Follow Up Call\",\"Demo\",\"Email Contract\"],\n                    fieldname:\"type_of_interaction\"},\n    {label:__(\"Result\"), fieldtype:\"Select\", options: \n    [\"Status Quo\",\"Warmer\",\"Colder\",\"Closed Lost\",\"Closed Won\"], fieldname:\"result\"},\n    {'fieldname': 'responsible', 'fieldtype': 'Link', options:\"User\", 'default': user, 'label': 'Responsible', 'reqd': 0},\n    {'fieldname': 'create_task', 'fieldtype': 'Check', 'default': true, 'label': 'Create Task'},\n  \n\n    {fieldtype: \"Column Break\"},\n\n \n    {'fieldname': 'next_date', 'fieldtype': 'Date', \n    'label': 'Next Action Date', 'default': frappe.datetime.add_days(frappe.datetime.nowdate(),7), 'reqd': 0},\n    {'fieldname': 'next_action_by', 'fieldtype': 'Link', options:\"User\", 'default': user,'label': 'Next Action By', 'reqd': 0},\n    {'fieldname': 'comment', 'fieldtype': 'Text', 'label': 'Next Action Task', 'reqd': 1},\n    {fieldtype: \"Section Break\"},\n\n    {'fieldname': 'remark', 'fieldtype': 'Text Editor', 'label': 'Remarks', 'reqd': 1} \n\n\n],\nfunction(values){\n    var c = d.get_values()\n    var cmnt = \"Person Interacted with: \"+ c.person_interacted_with\n               +\"<br>Type of Interaction: \"+ c.type_of_interaction\n               +\"<br>Result: \"+ c.result \n               +\"<br>Next Action Date: \" +c.next_date \n               +\"<br>Next Action By: \"+ c.next_action_by \n               + \"<br>Next Action Task: \"+c.comment \n               + \"<br>Responsible: \"+c.responsible \n               + \"<br>Remarks: \"+c.remark \n\n                \n    var me = frm.doc\n    // start interaction master\n       frappe.call({\n            method: \"allyhomes.custom_method.add_interaction\",\n            args: {\n                doc:{\n                    doctype: \"Interaction Master\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    result: c.result,\n                    person_interacted_with: c.person_interacted_with,\n\n     //                responce_reson: c.responce_reson,\n                    next_action_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    // result: c.result,\n                    next_action_by: c.next_action_by,\n                    next_action_task: c.comment,\n                    remark: c.remark,\n                    responsible: c.responsible\n                    // next_date\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction master record created\");\n            }\n        });\n    //end interaction master\n//create todo\n    if(c.create_task==true){\n        frappe.call({\n                        method: \"allyhomes.custom_method.create_todo\",\n                        args: {\n                            owner: c.next_action_by,\n                            assigned_by: c.responsible,\n                            description: c.comment,\n                            date: c.next_date,\n                            reference_name: frm.doc.name,\n                            reference_type: frm.doc.doctype\n                        }\n                    })\n    }\n//end of create todo\n\n    return frappe.call({\n            method: \"frappe.desk.form.utils.add_comment\",\n            args: {\n                doc:{\n                    doctype: \"Communication\",\n                    communication_type: \"Comment\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    comment: \"cmnt\",\n                    subject: \"cmnt\",\n                    content: cmnt,\n                    responce_reson: c.responce_reson,\n                    next_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    result: c.result,\n                    next_action_by: c.next_action_by,\n                    reference_owner: frm.doc.owner,\n                    comment_by: user,\n                    user: user,\n                    sender_full_name:user_fullname,\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction Submited Successfully\");\n                        cur_frm.reload_doc();\n            if (cur_frm) {\n                        if (cur_frm.docname && (frappe.last_edited_communication[cur_frm.doctype] || {})[cur_frm.docname]) {\n                            delete frappe.last_edited_communication[cur_frm.doctype][cur_frm.docname];\n                        }\n                    }\n            }\n        });\n},\n'Add Interaction',\n'Submit','Add Interaction', \"btn-default\"\n)\n});\n\n                        // frm.refresh();\n\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Customer", 
  "modified": "2017-11-03 12:55:51.785127", 
  "name": "Customer-Client", 
  "script": "frappe.ui.form.on(\"Customer\", \"refresh\", function(frm, doctype, name) {\ncur_frm.add_custom_button(__('Add Interaction'), function() {\nvar d = frappe.prompt([\n    {'fieldname': 'person_interacted_with', 'fieldtype': 'Data', 'label': 'Person Interacted with', 'reqd': 0},    \n    {label:__(\"Type of Interaction\"), fieldtype:\"Select\",'default': \"Follow Up Call\",\n                    options: [\"Cold Call\",\"Follow Up Call\",\"Mail\",\"Cold Visit\",\"Follow Up Visit\",\"Existing Customer Visit\",\"SMS or Whatsapp\",\"Skype or Webex\"],\n                    fieldname:\"type_of_interaction\"},\n    {label:__(\"Result\"), fieldtype:\"Select\", options: \n    [\"Status Quo\",\"Warmer\",\"Colder\",\"Closed Lost\",\"Closed Won\"], fieldname:\"result\"},\n    {'fieldname': 'responsible', 'fieldtype': 'Link', options:\"User\", 'default': user, 'label': 'Responsible', 'reqd': 0},\n    {'fieldname': 'create_task', 'fieldtype': 'Check', 'default': true, 'label': 'Create Task'},\n    {fieldtype: \"Column Break\"},\n\n    {'fieldname': 'next_date', 'fieldtype': 'Date', \n    'label': 'Next Action Date', 'default': frappe.datetime.add_days(frappe.datetime.nowdate(),7), 'reqd': 0},\n    {'fieldname': 'next_action_by', 'fieldtype': 'Link', options:\"User\", 'default': user,'label': 'Next Action By', 'reqd': 0},\n    {'fieldname': 'comment', 'fieldtype': 'Text', 'label': 'Next Action Task', 'reqd': 1},\n    {fieldtype: \"Section Break\"},\n\n    {'fieldname': 'remarks', 'fieldtype': 'Text Editor', 'label': 'Remarks', 'reqd': 1} \n\n\n],\nfunction(values){\n    var c = d.get_values()\n    var cmnt = \"Person Interacted with: \"+ c.person_interacted_with\n               +\"<br>Type of Interaction: \"+ c.type_of_interaction\n               +\"<br>Result: \"+ c.result \n               +\"<br>Next Action Date: \" +c.next_date \n               +\"<br>Next Action By: \"+ c.next_action_by \n               + \"<br>Next Action Task: \"+c.comment \n               + \"<br>Responsible: \"+c.responsible \n               + \"<br>Remarks: \"+c.remarks\n\n                \n    var me = frm.doc\n    // start interaction master\n       frappe.call({\n            method: \"shopchemical.custom_methods.add_interaction\",\n            args: {\n                doc:{\n                    doctype: \"Interaction Master\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    result: c.result,\n                    person_interacted_with: c.person_interacted_with,\n\n     //                responce_reson: c.responce_reson,\n                    next_action_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    // result: c.result,\n                    next_action_by: c.next_action_by,\n                    next_action_task: c.comment,\n                    remakrs: c.remarks,\n                    responsible: c.responsible\n                    // next_date\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction master record created\");\n            }\n        });\n    //end interaction master\n//create todo\nconsole.log(c.create_task);\n    if(c.create_task==true){\n        frappe.call({\n                        method: \"shopchemical.custom_methods.create_todo\",\n                        args: {\n                            owner: c.next_action_by,\n                            assigned_by: c.responsible,\n                            description: c.comment,\n                            date: c.next_date,\n                            reference_name: frm.doc.name,\n                            reference_type: frm.doc.doctype\n                        }\n                    })\n    }\n//end of create todo\n\n    return frappe.call({\n            method: \"frappe.desk.form.utils.add_comment\",\n            args: {\n                doc:{\n                    doctype: \"Communication\",\n                    communication_type: \"Comment\",\n                    reference_doctype: frm.doc.doctype,\n                    reference_name: frm.doc.name,\n                    comment: \"cmnt\",\n                    subject: \"cmnt\",\n                    content: cmnt,\n                    responce_reson: c.responce_reson,\n                    next_date: c.next_date,\n                    type_of_interaction: c.type_of_interaction,\n                    result: c.result,\n                    next_action_by: c.next_action_by,\n                    reference_owner: frm.doc.owner,\n                    comment_by: user,\n                    user: user,\n                    sender_full_name:user_fullname,\n                }\n            },\n            callback: function(r) {\n                        msgprint(\"Interaction Submited Successfully\");\n                        cur_frm.reload_doc();\n            if (cur_frm) {\n                        if (cur_frm.docname && (frappe.last_edited_communication[cur_frm.doctype] || {})[cur_frm.docname]) {\n                            delete frappe.last_edited_communication[cur_frm.doctype][cur_frm.docname];\n                        }\n                    }\n            }\n        });\n},\n'Add Interaction',\n'Submit','Add Interaction', \"btn-default\"\n)\n});\n\n                        // frm.refresh();\n\n});", 
  "script_type": "Client"
 }
]